<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VideoFlex - Interface Adaptável para Vídeos</title>
    <style>
      :root {
        --bg: #070b14;
        --panel: #111827;
        --panel-2: #0f172a;
        --line: #243044;
        --text: #e5e7eb;
        --muted: #9ca3af;
        --accent: #38bdf8;
        --accent-2: #22d3ee;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color: var(--text);
        background: radial-gradient(circle at top, #172554 0%, var(--bg) 45%);
      }

      .app {
        width: min(1100px, 100%);
        margin-inline: auto;
        padding: 1.2rem;
      }

      h1 {
        margin: 0;
        font-size: clamp(1.4rem, 2.2vw, 2rem);
      }

      .subtitle {
        margin: 0.5rem 0 1rem;
        color: var(--muted);
      }

      .layout {
        display: grid;
        gap: 1rem;
        grid-template-columns: minmax(260px, 330px) minmax(0, 1fr);
      }

      .panel {
        background: color-mix(in srgb, var(--panel) 90%, black);
        border: 1px solid var(--line);
        border-radius: 14px;
        padding: 1rem;
      }

      .panel h2 {
        margin-top: 0;
        font-size: 1.1rem;
      }

      label {
        display: block;
        margin-bottom: 0.35rem;
        font-size: 0.92rem;
      }

      input,
      button {
        width: 100%;
        font: inherit;
        border-radius: 10px;
      }

      input {
        border: 1px solid #334155;
        background: #060b17;
        color: var(--text);
        padding: 0.62rem 0.7rem;
        margin-bottom: 0.65rem;
      }

      button {
        border: 1px solid #334155;
        background: #182338;
        color: var(--text);
        padding: 0.64rem 0.78rem;
        cursor: pointer;
      }

      button.primary {
        background: linear-gradient(135deg, var(--accent), var(--accent-2));
        color: #082f49;
        border: none;
        font-weight: 700;
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .btn-row {
        display: grid;
        gap: 0.5rem;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        margin-top: 0.8rem;
      }

      .viewer {
        background: color-mix(in srgb, var(--panel-2) 92%, black);
        border: 1px solid var(--line);
        border-radius: 16px;
        padding: 1rem;
      }

      .player-shell {
        --ratio: 16 / 9;
        width: min(100%, 820px);
        margin-inline: auto;
        aspect-ratio: var(--ratio);
        border-radius: 14px;
        overflow: hidden;
        border: 1px solid #334155;
        background: #000;
        display: grid;
        place-items: center;
      }

      video {
        width: 100%;
        height: 100%;
        object-fit: contain;
        background: #000;
      }

      .meta {
        margin-top: 0.75rem;
        color: #bae6fd;
        text-align: center;
        font-size: 0.95rem;
      }

      .list {
        margin: 1rem 0 0;
        padding: 0;
        list-style: none;
        display: grid;
        gap: 0.55rem;
        max-height: 310px;
        overflow: auto;
      }

      .item {
        border: 1px solid #334155;
        background: #091224;
        color: var(--text);
        border-radius: 10px;
        padding: 0.62rem;
        text-align: left;
      }

      .item.active {
        border-color: var(--accent);
        box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--accent) 60%, transparent);
      }

      .tip {
        margin-top: 0.6rem;
        font-size: 0.82rem;
        color: var(--muted);
      }

      @media (max-width: 900px) {
        .layout {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <main class="app">
      <h1>VideoFlex</h1>
      <p class="subtitle">Uma interface de vídeos que se adapta automaticamente ao formato de cada vídeo (vertical, horizontal ou quadrado).</p>

      <section class="layout">
        <aside class="panel">
          <h2>Adicionar vídeos</h2>

          <label for="title">Título (opcional)</label>
          <input id="title" placeholder="Ex.: Trailer oficial" />

          <label for="url">URL do vídeo</label>
          <input id="url" placeholder="https://exemplo.com/video.mp4" />
          <button id="addUrl" class="primary">Adicionar URL</button>

          <hr style="border-color:#243044; margin:1rem 0;" />

          <label for="files">Ou selecione arquivos locais</label>
          <input id="files" type="file" accept="video/*" multiple />
          <button id="addFiles">Adicionar arquivos</button>

          <div class="btn-row">
            <button id="prevBtn">Anterior</button>
            <button id="nextBtn">Próximo</button>
          </div>

          <ul id="playlist" class="list"></ul>
          <p class="tip">Dica: a área do player muda o <code>aspect-ratio</code> ao carregar os metadados do vídeo.</p>
        </aside>

        <section class="viewer">
          <div id="playerShell" class="player-shell">
            <video id="player" controls playsinline></video>
          </div>
          <p id="status" class="meta">Nenhum vídeo selecionado.</p>
        </section>
      </section>
    </main>

    <script>
      const titleInput = document.getElementById('title');
      const urlInput = document.getElementById('url');
      const fileInput = document.getElementById('files');
      const addUrlBtn = document.getElementById('addUrl');
      const addFilesBtn = document.getElementById('addFiles');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const playlistEl = document.getElementById('playlist');
      const player = document.getElementById('player');
      const playerShell = document.getElementById('playerShell');
      const statusEl = document.getElementById('status');

      const playlist = [];
      let currentIndex = -1;

      function createTitle(source, fallbackPrefix) {
        const cleaned = source.trim();
        return cleaned || `${fallbackPrefix} ${playlist.length + 1}`;
      }

      function updateControls() {
        const hasItems = playlist.length > 0;
        prevBtn.disabled = !hasItems;
        nextBtn.disabled = !hasItems;
      }

      function renderPlaylist() {
        playlistEl.innerHTML = '';
        playlist.forEach((item, index) => {
          const button = document.createElement('button');
          button.className = `item ${index === currentIndex ? 'active' : ''}`;
          button.type = 'button';
          button.textContent = `${index + 1}. ${item.title}`;
          button.addEventListener('click', () => playAt(index));

          const li = document.createElement('li');
          li.appendChild(button);
          playlistEl.appendChild(li);
        });
      }

      function describeRatio(w, h) {
        if (!w || !h) return 'desconhecido';
        const ratio = w / h;
        if (ratio > 1.2) return 'horizontal';
        if (ratio < 0.85) return 'vertical';
        return 'quadrado/quase quadrado';
      }

      function applyVideoRatio() {
        const w = player.videoWidth;
        const h = player.videoHeight;
        if (!w || !h) return;

        playerShell.style.setProperty('--ratio', `${w} / ${h}`);
        const kind = describeRatio(w, h);
        const currentTitle = playlist[currentIndex]?.title || 'Vídeo';
        statusEl.textContent = `${currentTitle} • ${w}x${h} (${kind})`;
      }

      function playAt(index) {
        if (index < 0 || index >= playlist.length) return;
        currentIndex = index;
        player.src = playlist[index].src;
        player.load();
        player.play().catch(() => {
          statusEl.textContent = `Vídeo carregado: ${playlist[index].title}. Clique em play para iniciar.`;
        });
        renderPlaylist();
      }

      function addVideo(src, title) {
        playlist.push({ src, title });
        updateControls();
        renderPlaylist();
        if (currentIndex === -1) playAt(0);
      }

      addUrlBtn.addEventListener('click', () => {
        const url = urlInput.value.trim();
        if (!url) {
          statusEl.textContent = 'Informe uma URL de vídeo válida.';
          return;
        }

        addVideo(url, createTitle(titleInput.value, 'URL'));
        titleInput.value = '';
        urlInput.value = '';
      });

      addFilesBtn.addEventListener('click', () => {
        const files = Array.from(fileInput.files || []);
        if (!files.length) {
          statusEl.textContent = 'Selecione pelo menos um arquivo de vídeo.';
          return;
        }

        files.forEach((file) => {
          const objectUrl = URL.createObjectURL(file);
          addVideo(objectUrl, createTitle(file.name, 'Arquivo'));
        });

        fileInput.value = '';
      });

      nextBtn.addEventListener('click', () => {
        if (!playlist.length) return;
        const next = (currentIndex + 1) % playlist.length;
        playAt(next);
      });

      prevBtn.addEventListener('click', () => {
        if (!playlist.length) return;
        const prev = (currentIndex - 1 + playlist.length) % playlist.length;
        playAt(prev);
      });

      player.addEventListener('loadedmetadata', applyVideoRatio);
      player.addEventListener('error', () => {
        statusEl.textContent = 'Erro ao carregar o vídeo. Verifique a URL ou permissões do arquivo.';
      });

      updateControls();
      renderPlaylist();
    </script>
  </body>
</html>
